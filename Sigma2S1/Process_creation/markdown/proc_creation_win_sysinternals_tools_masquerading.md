# proc_creation_win_sysinternals_tools_masquerading

## Title
Potential Binary Impersonating Sysinternals Tools

## ID
7cce6fc8-a07f-4d84-a53e-96e1879843c9

## Author
frack113

## Date
2021-12-20

## Tags
attack.execution, attack.defense-evasion, attack.t1218, attack.t1202

## Description
Detects binaries that use the same name as legitimate sysinternals tools to evade detection

## References
https://learn.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite

## False Positives
Unknown

## SentinelOne Query
```
EventType = "Process Creation" AND (EndpointOS = "windows" AND ((TgtProcImagePath endswithCIS "\accesschk.exe" OR TgtProcImagePath endswithCIS "\accesschk64.exe" OR TgtProcImagePath endswithCIS "\AccessEnum.exe" OR TgtProcImagePath endswithCIS "\ADExplorer.exe" OR TgtProcImagePath endswithCIS "\ADExplorer64.exe" OR TgtProcImagePath endswithCIS "\ADInsight.exe" OR TgtProcImagePath endswithCIS "\ADInsight64.exe" OR TgtProcImagePath endswithCIS "\adrestore.exe" OR TgtProcImagePath endswithCIS "\adrestore64.exe" OR TgtProcImagePath endswithCIS "\Autologon.exe" OR TgtProcImagePath endswithCIS "\Autologon64.exe" OR TgtProcImagePath endswithCIS "\Autoruns.exe" OR TgtProcImagePath endswithCIS "\Autoruns64.exe" OR TgtProcImagePath endswithCIS "\autorunsc.exe" OR TgtProcImagePath endswithCIS "\autorunsc64.exe" OR TgtProcImagePath endswithCIS "\Bginfo.exe" OR TgtProcImagePath endswithCIS "\Bginfo64.exe" OR TgtProcImagePath endswithCIS "\Cacheset.exe" OR TgtProcImagePath endswithCIS "\Cacheset64.exe" OR TgtProcImagePath endswithCIS "\Clockres.exe" OR TgtProcImagePath endswithCIS "\Clockres64.exe" OR TgtProcImagePath endswithCIS "\Contig.exe" OR TgtProcImagePath endswithCIS "\Contig64.exe" OR TgtProcImagePath endswithCIS "\Coreinfo.exe" OR TgtProcImagePath endswithCIS "\Coreinfo64.exe" OR TgtProcImagePath endswithCIS "\CPUSTRES.EXE" OR TgtProcImagePath endswithCIS "\CPUSTRES64.EXE" OR TgtProcImagePath endswithCIS "\ctrl2cap.exe" OR TgtProcImagePath endswithCIS "\Dbgview.exe" OR TgtProcImagePath endswithCIS "\dbgview64.exe" OR TgtProcImagePath endswithCIS "\Desktops.exe" OR TgtProcImagePath endswithCIS "\Desktops64.exe" OR TgtProcImagePath endswithCIS "\disk2vhd.exe" OR TgtProcImagePath endswithCIS "\disk2vhd64.exe" OR TgtProcImagePath endswithCIS "\diskext.exe" OR TgtProcImagePath endswithCIS "\diskext64.exe" OR TgtProcImagePath endswithCIS "\Diskmon.exe" OR TgtProcImagePath endswithCIS "\Diskmon64.exe" OR TgtProcImagePath endswithCIS "\DiskView.exe" OR TgtProcImagePath endswithCIS "\DiskView64.exe" OR TgtProcImagePath endswithCIS "\du.exe" OR TgtProcImagePath endswithCIS "\du64.exe" OR TgtProcImagePath endswithCIS "\efsdump.exe" OR TgtProcImagePath endswithCIS "\FindLinks.exe" OR TgtProcImagePath endswithCIS "\FindLinks64.exe" OR TgtProcImagePath endswithCIS "\handle.exe" OR TgtProcImagePath endswithCIS "\handle64.exe" OR TgtProcImagePath endswithCIS "\hex2dec.exe" OR TgtProcImagePath endswithCIS "\hex2dec64.exe" OR TgtProcImagePath endswithCIS "\junction.exe" OR TgtProcImagePath endswithCIS "\junction64.exe" OR TgtProcImagePath endswithCIS "\ldmdump.exe" OR TgtProcImagePath endswithCIS "\listdlls.exe" OR TgtProcImagePath endswithCIS "\listdlls64.exe" OR TgtProcImagePath endswithCIS "\livekd.exe" OR TgtProcImagePath endswithCIS "\livekd64.exe" OR TgtProcImagePath endswithCIS "\loadOrd.exe" OR TgtProcImagePath endswithCIS "\loadOrd64.exe" OR TgtProcImagePath endswithCIS "\loadOrdC.exe" OR TgtProcImagePath endswithCIS "\loadOrdC64.exe" OR TgtProcImagePath endswithCIS "\logonsessions.exe" OR TgtProcImagePath endswithCIS "\logonsessions64.exe" OR TgtProcImagePath endswithCIS "\movefile.exe" OR TgtProcImagePath endswithCIS "\movefile64.exe" OR TgtProcImagePath endswithCIS "\notmyfault.exe" OR TgtProcImagePath endswithCIS "\notmyfault64.exe" OR TgtProcImagePath endswithCIS "\notmyfaultc.exe" OR TgtProcImagePath endswithCIS "\notmyfaultc64.exe" OR TgtProcImagePath endswithCIS "\ntfsinfo.exe" OR TgtProcImagePath endswithCIS "\ntfsinfo64.exe" OR TgtProcImagePath endswithCIS "\pendmoves.exe" OR TgtProcImagePath endswithCIS "\pendmoves64.exe" OR TgtProcImagePath endswithCIS "\pipelist.exe" OR TgtProcImagePath endswithCIS "\pipelist64.exe" OR TgtProcImagePath endswithCIS "\portmon.exe" OR TgtProcImagePath endswithCIS "\procdump.exe" OR TgtProcImagePath endswithCIS "\procdump64.exe" OR TgtProcImagePath endswithCIS "\procexp.exe" OR TgtProcImagePath endswithCIS "\procexp64.exe" OR TgtProcImagePath endswithCIS "\Procmon.exe" OR TgtProcImagePath endswithCIS "\Procmon64.exe" OR TgtProcImagePath endswithCIS "\psExec.exe" OR TgtProcImagePath endswithCIS "\psExec64.exe" OR TgtProcImagePath endswithCIS "\psfile.exe" OR TgtProcImagePath endswithCIS "\psfile64.exe" OR TgtProcImagePath endswithCIS "\psGetsid.exe" OR TgtProcImagePath endswithCIS "\psGetsid64.exe" OR TgtProcImagePath endswithCIS "\psInfo.exe" OR TgtProcImagePath endswithCIS "\psInfo64.exe" OR TgtProcImagePath endswithCIS "\pskill.exe" OR TgtProcImagePath endswithCIS "\pskill64.exe" OR TgtProcImagePath endswithCIS "\pslist.exe" OR TgtProcImagePath endswithCIS "\pslist64.exe" OR TgtProcImagePath endswithCIS "\psLoggedon.exe" OR TgtProcImagePath endswithCIS "\psLoggedon64.exe" OR TgtProcImagePath endswithCIS "\psloglist.exe" OR TgtProcImagePath endswithCIS "\psloglist64.exe" OR TgtProcImagePath endswithCIS "\pspasswd.exe" OR TgtProcImagePath endswithCIS "\pspasswd64.exe" OR TgtProcImagePath endswithCIS "\psping.exe" OR TgtProcImagePath endswithCIS "\psping64.exe" OR TgtProcImagePath endswithCIS "\psService.exe" OR TgtProcImagePath endswithCIS "\psService64.exe" OR TgtProcImagePath endswithCIS "\psshutdown.exe" OR TgtProcImagePath endswithCIS "\psshutdown64.exe" OR TgtProcImagePath endswithCIS "\pssuspend.exe" OR TgtProcImagePath endswithCIS "\pssuspend64.exe" OR TgtProcImagePath endswithCIS "\RAMMap.exe" OR TgtProcImagePath endswithCIS "\RDCMan.exe" OR TgtProcImagePath endswithCIS "\RegDelNull.exe" OR TgtProcImagePath endswithCIS "\RegDelNull64.exe" OR TgtProcImagePath endswithCIS "\regjump.exe" OR TgtProcImagePath endswithCIS "\ru.exe" OR TgtProcImagePath endswithCIS "\ru64.exe" OR TgtProcImagePath endswithCIS "\sdelete.exe" OR TgtProcImagePath endswithCIS "\sdelete64.exe" OR TgtProcImagePath endswithCIS "\ShareEnum.exe" OR TgtProcImagePath endswithCIS "\ShareEnum64.exe" OR TgtProcImagePath endswithCIS "\shellRunas.exe" OR TgtProcImagePath endswithCIS "\sigcheck.exe" OR TgtProcImagePath endswithCIS "\sigcheck64.exe" OR TgtProcImagePath endswithCIS "\streams.exe" OR TgtProcImagePath endswithCIS "\streams64.exe" OR TgtProcImagePath endswithCIS "\strings.exe" OR TgtProcImagePath endswithCIS "\strings64.exe" OR TgtProcImagePath endswithCIS "\sync.exe" OR TgtProcImagePath endswithCIS "\sync64.exe" OR TgtProcImagePath endswithCIS "\Sysmon.exe" OR TgtProcImagePath endswithCIS "\Sysmon64.exe" OR TgtProcImagePath endswithCIS "\tcpvcon.exe" OR TgtProcImagePath endswithCIS "\tcpvcon64.exe" OR TgtProcImagePath endswithCIS "\tcpview.exe" OR TgtProcImagePath endswithCIS "\tcpview64.exe" OR TgtProcImagePath endswithCIS "\Testlimit.exe" OR TgtProcImagePath endswithCIS "\Testlimit64.exe" OR TgtProcImagePath endswithCIS "\vmmap.exe" OR TgtProcImagePath endswithCIS "\vmmap64.exe" OR TgtProcImagePath endswithCIS "\Volumeid.exe" OR TgtProcImagePath endswithCIS "\Volumeid64.exe" OR TgtProcImagePath endswithCIS "\whois.exe" OR TgtProcImagePath endswithCIS "\whois64.exe" OR TgtProcImagePath endswithCIS "\Winobj.exe" OR TgtProcImagePath endswithCIS "\Winobj64.exe" OR TgtProcImagePath endswithCIS "\ZoomIt.exe" OR TgtProcImagePath endswithCIS "\ZoomIt64.exe") AND (NOT (TgtProcPublisher IS NOT EMPTY OR (TgtProcPublisher In Contains AnyCase ("Sysinternals - www.sysinternals.com","Sysinternals"))))))

```