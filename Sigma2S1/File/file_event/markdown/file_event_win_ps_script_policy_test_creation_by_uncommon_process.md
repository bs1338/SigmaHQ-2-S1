# file_event_win_ps_script_policy_test_creation_by_uncommon_process

## Title
PSScriptPolicyTest Creation By Uncommon Process

## ID
1027d292-dd87-4a1a-8701-2abe04d7783c

## Author
Nasreddine Bencherchali (Nextron Systems)

## Date
2023-06-01

## Tags
attack.defense-evasion

## Description
Detects the creation of the "PSScriptPolicyTest" PowerShell script by an uncommon process. This file is usually generated by Microsoft Powershell to test against Applocker.

## References
https://www.paloaltonetworks.com/blog/security-operations/stopping-powershell-without-powershell/

## False Positives
Unknown

## SentinelOne Query
```
ObjectType = "File" AND (EndpointOS = "windows" AND (TgtFilePath containsCIS "__PSScriptPolicyTest_" AND (NOT (SrcProcImagePath endswithCIS ":\Program Files\PowerShell\7-preview\pwsh.exe" OR SrcProcImagePath endswithCIS ":\Program Files\PowerShell\7\pwsh.exe" OR SrcProcImagePath endswithCIS ":\Windows\System32\dsac.exe" OR SrcProcImagePath endswithCIS ":\Windows\System32\sdiagnhost.exe" OR SrcProcImagePath endswithCIS ":\Windows\System32\ServerManager.exe" OR SrcProcImagePath endswithCIS ":\Windows\System32\WindowsPowerShell\v1.0\powershell_ise.exe" OR SrcProcImagePath endswithCIS ":\Windows\System32\WindowsPowerShell\v1.0\powershell.exe" OR SrcProcImagePath endswithCIS ":\Windows\System32\wsmprovhost.exe" OR SrcProcImagePath endswithCIS ":\Windows\SysWOW64\sdiagnhost.exe" OR SrcProcImagePath endswithCIS ":\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell_ise.exe" OR SrcProcImagePath endswithCIS ":\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe"))))

```